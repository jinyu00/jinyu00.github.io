<!DOCTYPE html>
<html style="display: none;" lang="zh">
    <head>
    <meta charset="utf-8">
    <meta name="baidu-site-verification" content="RC70b8mZ9A" />
    <meta name="msvalidate.01" content="325714A6172A8D425D843D8163893A54" />
    <meta name="google-site-verification" content="QAmqP2zEYaSBqoZ9w1x5RdOflLW2Fir2-yVs5LTIUxA" />
    <meta name="google-site-verification" content="QgUuEnRKG0PKdnDrOxnq55x7VxQbCiprrMJpfakMlow" />
    <!--
        © Material Theme
        https://github.com/viosey/hexo-theme-material
        Version: 1.5.0 -->
    <script>
        window.materialVersion = "1.5.0"
        // Delete localstorage with these tags
        window.oldVersion = [
            'codestartv1',
            '1.3.4',
            '1.4.0',
            '1.4.0b1'
        ]
    </script>


    <!-- dns prefetch -->
    <meta http-equiv="x-dns-prefetch-control" content="on">



    <link rel="dns-prefetch" href="https://busuanzi.ibruce.info"/>



        <link rel="dns-prefetch" href="https://cdn-city.livere.com"/>










    <!-- Title -->
    
    <title>
        
            一步一步pwn路由器之radare2使用全解 | 
        
        穷则变，变则通，通则久
    </title>

    <!-- Meta & Info -->
    <meta http-equiv="X-UA-Compatible" content="IE=Edge,chrome=1">
    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">
    <meta name="format-detection" content="telephone=no"/>
    <meta name="theme-color" content="#0097A7">
    <meta name="author" content="hac425">
    <meta name="description" itemprop="description" content="">
    <meta name="keywords" content=",radare2">

    <!-- Import lsloader -->
    <script>(function(){window.lsloader={jsRunSequence:[],jsnamemap:{},cssnamemap:{}};lsloader.removeLS=function(key){try{localStorage.removeItem(key)}catch(e){}};lsloader.setLS=function(key,val){try{localStorage.setItem(key,val)}catch(e){}};lsloader.getLS=function(key){var val="";try{val=localStorage.getItem(key)}catch(e){val=""}return val};versionString="/*"+(window.materialVersion||"unknownVersion")+"*/";lsloader.clean=function(){try{var keys=[];for(var i=0;i<localStorage.length;i++){keys.push(localStorage.key(i))}keys.forEach(function(key){var data=lsloader.getLS(key);if(window.oldVersion){var remove=window.oldVersion.reduce(function(p,c){return p||data.indexOf("/*"+c+"*/")!==-1},false);if(remove){lsloader.removeLS(key)}}})}catch(e){}};lsloader.clean();lsloader.load=function(jsname,jspath,cssonload,isJs){if(typeof cssonload==="boolean"){isJs=cssonload;cssonload=undefined}isJs=isJs||false;cssonload=cssonload||function(){};var code;code=this.getLS(jsname);if(code&&code.indexOf(versionString)===-1){this.removeLS(jsname);this.requestResource(jsname,jspath,cssonload,isJs);return}if(code){var versionNumber=code.split(versionString)[0];if(versionNumber!=jspath){console.log("reload:"+jspath);this.removeLS(jsname);this.requestResource(jsname,jspath,cssonload,isJs);return}code=code.split(versionString)[1];if(isJs){this.jsRunSequence.push({name:jsname,code:code});this.runjs(jspath,jsname,code)}else{document.getElementById(jsname).appendChild(document.createTextNode(code));cssonload()}}else{this.requestResource(jsname,jspath,cssonload,isJs)}};lsloader.requestResource=function(name,path,cssonload,isJs){var that=this;if(isJs){this.iojs(path,name,function(path,name,code){that.setLS(name,path+versionString+code);that.runjs(path,name,code)})}else{this.iocss(path,name,function(code){document.getElementById(name).appendChild(document.createTextNode(code));that.setLS(name,path+versionString+code)},cssonload)}};lsloader.iojs=function(path,jsname,callback){var that=this;that.jsRunSequence.push({name:jsname,code:""});try{var xhr=new XMLHttpRequest;xhr.open("get",path,true);xhr.onreadystatechange=function(){if(xhr.readyState==4){if(xhr.status>=200&&xhr.status<300||xhr.status==304){if(xhr.response!=""){callback(path,jsname,xhr.response);return}}that.jsfallback(path,jsname)}};xhr.send(null)}catch(e){that.jsfallback(path,jsname)}};lsloader.iocss=function(path,jsname,callback,cssonload){var that=this;try{var xhr=new XMLHttpRequest;xhr.open("get",path,true);xhr.onreadystatechange=function(){if(xhr.readyState==4){if(xhr.status>=200&&xhr.status<300||xhr.status==304){if(xhr.response!=""){callback(xhr.response);cssonload();return}}that.cssfallback(path,jsname,cssonload)}};xhr.send(null)}catch(e){that.cssfallback(path,jsname,cssonload)}};lsloader.iofonts=function(path,jsname,callback,cssonload){var that=this;try{var xhr=new XMLHttpRequest;xhr.open("get",path,true);xhr.onreadystatechange=function(){if(xhr.readyState==4){if(xhr.status>=200&&xhr.status<300||xhr.status==304){if(xhr.response!=""){callback(xhr.response);cssonload();return}}that.cssfallback(path,jsname,cssonload)}};xhr.send(null)}catch(e){that.cssfallback(path,jsname,cssonload)}};lsloader.runjs=function(path,name,code){if(!!name&&!!code){for(var k in this.jsRunSequence){if(this.jsRunSequence[k].name==name){this.jsRunSequence[k].code=code}}}if(!!this.jsRunSequence[0]&&!!this.jsRunSequence[0].code&&this.jsRunSequence[0].status!="failed"){var script=document.createElement("script");script.appendChild(document.createTextNode(this.jsRunSequence[0].code));script.type="text/javascript";document.getElementsByTagName("head")[0].appendChild(script);this.jsRunSequence.shift();if(this.jsRunSequence.length>0){this.runjs()}}else if(!!this.jsRunSequence[0]&&this.jsRunSequence[0].status=="failed"){var that=this;var script=document.createElement("script");script.src=this.jsRunSequence[0].path;script.type="text/javascript";this.jsRunSequence[0].status="loading";script.onload=function(){that.jsRunSequence.shift();if(that.jsRunSequence.length>0){that.runjs()}};document.body.appendChild(script)}};lsloader.tagLoad=function(path,name){this.jsRunSequence.push({name:name,code:"",path:path,status:"failed"});this.runjs()};lsloader.jsfallback=function(path,name){if(!!this.jsnamemap[name]){return}else{this.jsnamemap[name]=name}for(var k in this.jsRunSequence){if(this.jsRunSequence[k].name==name){this.jsRunSequence[k].code="";this.jsRunSequence[k].status="failed";this.jsRunSequence[k].path=path}}this.runjs()};lsloader.cssfallback=function(path,name,cssonload){if(!!this.cssnamemap[name]){return}else{this.cssnamemap[name]=1}var link=document.createElement("link");link.type="text/css";link.href=path;link.rel="stylesheet";link.onload=link.onerror=cssonload;var root=document.getElementsByTagName("script")[0];root.parentNode.insertBefore(link,root)};lsloader.runInlineScript=function(scriptId,codeId){var code=document.getElementById(codeId).innerText;this.jsRunSequence.push({name:scriptId,code:code});this.runjs()};lsloader.loadCombo=function(jslist){var updateList="";var requestingModules={};for(var k in jslist){var LS=this.getLS(jslist[k].name);if(!!LS){var version=LS.split(versionString)[0];var code=LS.split(versionString)[1]}else{var version=""}if(version==jslist[k].path){this.jsRunSequence.push({name:jslist[k].name,code:code,path:jslist[k].path})}else{this.jsRunSequence.push({name:jslist[k].name,code:null,path:jslist[k].path,status:"comboloading"});requestingModules[jslist[k].name]=true;updateList+=(updateList==""?"":";")+jslist[k].path}}var that=this;if(!!updateList){var xhr=new XMLHttpRequest;xhr.open("get",combo+updateList,true);xhr.onreadystatechange=function(){if(xhr.readyState==4){if(xhr.status>=200&&xhr.status<300||xhr.status==304){if(xhr.response!=""){that.runCombo(xhr.response,requestingModules);return}}else{for(var i in that.jsRunSequence){if(requestingModules[that.jsRunSequence[i].name]){that.jsRunSequence[i].status="failed"}}that.runjs()}}};xhr.send(null)}this.runjs()};lsloader.runCombo=function(comboCode,requestingModules){comboCode=comboCode.split("/*combojs*/");comboCode.shift();for(var k in this.jsRunSequence){if(!!requestingModules[this.jsRunSequence[k].name]&&!!comboCode[0]){this.jsRunSequence[k].status="comboJS";this.jsRunSequence[k].code=comboCode[0];this.setLS(this.jsRunSequence[k].name,this.jsRunSequence[k].path+versionString+comboCode[0]);comboCode.shift()}}this.runjs()}})();</script>

    <!-- Import queue -->
    <script>function Queue(){this.dataStore=[];this.offer=b;this.poll=d;this.execNext=a;this.debug=false;this.startDebug=c;function b(e){if(this.debug){console.log("Offered a Queued Function.")}if(typeof e==="function"){this.dataStore.push(e)}else{console.log("You must offer a function.")}}function d(){if(this.debug){console.log("Polled a Queued Function.")}return this.dataStore.shift()}function a(){var e=this.poll();if(e!==undefined){if(this.debug){console.log("Run a Queued Function.")}e()}}function c(){this.debug=true}}var queue=new Queue();</script>

    <!-- Favicons -->
    <link rel="icon shortcut" type="image/ico" href="/img/girl.png">
    <link rel="icon" sizes="192x192" href="/img/girl.png">
    <link rel="apple-touch-icon" href="/img/girl.png">

    <!--iOS -->
    <meta name="apple-mobile-web-app-title" content="Title">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <meta name="HandheldFriendly" content="True">
    <meta name="MobileOptimized" content="480">

    <!-- Add to homescreen for Chrome on Android -->
    <meta name="mobile-web-app-capable" content="yes">

    <!-- Add to homescreen for Safari on iOS -->
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <meta name="apple-mobile-web-app-title" content="穷则变，变则通，通则久">

    <!-- Site Verification -->
    
    

    <!-- RSS -->
    

    <!--[if lte IE 9]>
        <link rel="stylesheet" href="/css/ie-blocker.css">

        
            <script src="/js/ie-blocker.zhCN.js"></script>
        
    <![endif]-->

    <!-- Import CSS -->
    
        <style id="material_css"></style><script>if(typeof window.lsLoadCSSMaxNums === "undefined")window.lsLoadCSSMaxNums = 0;window.lsLoadCSSMaxNums++;lsloader.load("material_css","/css/material.min.css?Z7a72R1E4SxzBKR/WGctOA==",function(){if(typeof window.lsLoadCSSNums === "undefined")window.lsLoadCSSNums = 0;window.lsLoadCSSNums++;if(window.lsLoadCSSNums == window.lsLoadCSSMaxNums)document.documentElement.style.display="";}, false)</script>
        <style id="style_css"></style><script>if(typeof window.lsLoadCSSMaxNums === "undefined")window.lsLoadCSSMaxNums = 0;window.lsLoadCSSMaxNums++;lsloader.load("style_css","/css/style.min.css?MKetZV3cUTfDxvMffaOezg==",function(){if(typeof window.lsLoadCSSNums === "undefined")window.lsLoadCSSNums = 0;window.lsLoadCSSNums++;if(window.lsLoadCSSNums == window.lsLoadCSSMaxNums)document.documentElement.style.display="";}, false)</script>

        

    

    

    <!-- Config CSS -->

<!-- Other Styles -->
<style>
  body, html {
    font-family: Roboto, "Helvetica Neue", Helvetica, "PingFang SC", "Hiragino Sans GB", "Microsoft YaHei", "微软雅黑", Arial, sans-serif;
    overflow-x: hidden !important;
  }
  
  code {
    font-family: Consolas, Monaco, 'Andale Mono', 'Ubuntu Mono', monospace;
  }

  a {
    color: #00838F;
  }

  .mdl-card__media,
  #search-label,
  #search-form-label:after,
  #scheme-Paradox .hot_tags-count,
  #scheme-Paradox .sidebar_archives-count,
  #scheme-Paradox .sidebar-colored .sidebar-header,
  #scheme-Paradox .sidebar-colored .sidebar-badge{
    background-color: #0097A7 !important;
  }

  /* Sidebar User Drop Down Menu Text Color */
  #scheme-Paradox .sidebar-colored .sidebar-nav>.dropdown>.dropdown-menu>li>a:hover,
  #scheme-Paradox .sidebar-colored .sidebar-nav>.dropdown>.dropdown-menu>li>a:focus {
    color: #0097A7 !important;
  }

  #post_entry-right-info,
  .sidebar-colored .sidebar-nav li:hover > a,
  .sidebar-colored .sidebar-nav li:hover > a i,
  .sidebar-colored .sidebar-nav li > a:hover,
  .sidebar-colored .sidebar-nav li > a:hover i,
  .sidebar-colored .sidebar-nav li > a:focus i,
  .sidebar-colored .sidebar-nav > .open > a,
  .sidebar-colored .sidebar-nav > .open > a:hover,
  .sidebar-colored .sidebar-nav > .open > a:focus,
  #ds-reset #ds-ctx .ds-ctx-entry .ds-ctx-head a {
    color: #0097A7 !important;
  }

  .toTop {
    background: #757575 !important;
  }

  .material-layout .material-post>.material-nav,
  .material-layout .material-index>.material-nav,
  .material-nav a {
    color: #757575;
  }

  #scheme-Paradox .MD-burger-layer {
    background-color: #757575;
  }

  #scheme-Paradox #post-toc-trigger-btn {
    color: #757575;
  }

  .post-toc a:hover {
    color: #00838F;
    text-decoration: underline;
  }

</style>


<!-- Theme Background Related-->

    <style>
      body{
        background-color: #F5F5F5;
      }

      /* blog_info bottom background */
      #scheme-Paradox .material-layout .something-else .mdl-card__supporting-text{
        background-color: #fff;
      }
    </style>




<!-- Fade Effect -->

    <style>
      .fade {
        transition: all 800ms linear;
        -webkit-transform: translate3d(0,0,0);
        -moz-transform: translate3d(0,0,0);
        -ms-transform: translate3d(0,0,0);
        -o-transform: translate3d(0,0,0);
        transform: translate3d(0,0,0);
        opacity: 1;
      }

      .fade.out{
        opacity: 0;
      }
    </style>


<!-- Import Font -->
<!-- Import Roboto -->

    <link href="https://fonts.googleapis.com/css?family=Roboto:300,400,500" rel="stylesheet">


<!-- Import Material Icon -->

    <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">




    <!-- Import jQuery -->
    
        <script>lsloader.load("jq_js","/js/jquery.min.js?ezyEvm8ST5CGfpA+kFFi1g==", true)</script>
    

    <!-- The Open Graph protocol -->
    <meta property="og:url" content="http://blog.hac425.top">
    <meta property="og:type" content="blog">
    <meta property="og:title" content="一步一步pwn路由器之radare2使用全解 | 穷则变，变则通，通则久">
    <meta property="og:image" content="http://blog.hac425.top/img/girl.png" />
    <meta property="og:description" content="">
    <meta property="og:article:tag" content="radare2"> 

    
        <meta property="article:published_time" content="Tue Oct 31 2017 15:12:00 GMT+0800" />
        <meta property="article:modified_time" content="Sat Jan 13 2018 15:46:18 GMT+0800" />
    

    <!-- The Twitter Card protocol -->
    <meta name="twitter:title" content="一步一步pwn路由器之radare2使用全解 | 穷则变，变则通，通则久">
    <meta name="twitter:description" content="">
    <meta name="twitter:image" content="http://blog.hac425.top/img/girl.png">
    <meta name="twitter:card" content="summary_large_image" />
    <meta name="twitter:url" content="http://blog.hac425.top" />

    <!-- Add canonical link for SEO -->
    
        <link rel="canonical" href="http://blog.hac425.top/2017/10/31/step_by_step_pwn_router_part7.html" />
    

    <!-- Structured-data for SEO -->
    
        


<script type="application/ld+json">
{
    "@context": "https://schema.org",
    "@type": "BlogPosting",
    "mainEntityOfPage": "http://blog.hac425.top/2017/10/31/step_by_step_pwn_router_part7.html",
    "headline": "一步一步pwn路由器之radare2使用全解",
    "datePublished": "Tue Oct 31 2017 15:12:00 GMT+0800",
    "dateModified": "Sat Jan 13 2018 15:46:18 GMT+0800",
    "author": {
        "@type": "Person",
        "name": "hac425",
        "image": {
            "@type": "ImageObject",
            "url": "/img/girl.png"
        },
        "description": "纵横捭阖，冷心为上"
    },
    "publisher": {
        "@type": "Organization",
        "name": "穷则变，变则通，通则久",
        "logo": {
            "@type":"ImageObject",
            "url": "/img/girl.png"
        }
    },
    "keywords": ",radare2",
    "description": "",
}
</script>


    

    <!-- Analytics -->
    
    
        <script>
    var _hmt = _hmt || [];
    (function() {var hm = document.createElement('script');
    hm.src = 'https://hm.baidu.com/hm.js?99747687c69d73d9102f032f78f03e96';
    var s = document.getElementsByTagName('script')[0];
    s.parentNode.insertBefore(hm, s);
    })();
</script>
    
    

    <!-- Custom Head -->
    

</head>


    
        <body id="scheme-Paradox" class="lazy">
            <div class="material-layout  mdl-js-layout has-drawer is-upgraded">
                

                <!-- Main Container -->
                <main class="material-layout__content" id="main">

                    <!-- Top Anchor -->
                    <div id="top"></div>

                    
                        <!-- Hamburger Button -->
                        <button class="MD-burger-icon sidebar-toggle">
                            <span class="MD-burger-layer"></span>
                        </button>
                    

                    <!-- Post TOC -->

    
    <!-- Back Button -->
    <!--
    <div class="material-back" id="backhome-div" tabindex="0">
        <a class="mdl-button mdl-js-button mdl-js-ripple-effect mdl-button--icon"
           href="#" onclick="window.history.back();return false;"
           target="_self"
           role="button"
           data-upgraded=",MaterialButton,MaterialRipple">
            <i class="material-icons" role="presentation">arrow_back</i>
            <span class="mdl-button__ripple-container">
                <span class="mdl-ripple"></span>
            </span>
        </a>
    </div>
    -->


    <!-- Left aligned menu below button -->
    
    
    <button id="post-toc-trigger-btn"
        class="mdl-button mdl-js-button mdl-button--icon">
        <i class="material-icons">format_list_numbered</i>
    </button>

    <ul class="post-toc-wrap mdl-menu mdl-menu--bottom-left mdl-js-menu mdl-js-ripple-effect" for="post-toc-trigger-btn" style="max-height:80vh; overflow-y:scroll;">
        <ol class="post-toc"><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#前言"><span class="post-toc-number">1.</span> <span class="post-toc-text">前言</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#正文"><span class="post-toc-number">2.</span> <span class="post-toc-text">正文</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#rax2"><span class="post-toc-number">3.</span> <span class="post-toc-text">rax2</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#rabin2"><span class="post-toc-number">4.</span> <span class="post-toc-text">rabin2</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#rasm2"><span class="post-toc-number">5.</span> <span class="post-toc-text">rasm2</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#ragg2-ragg2·cc"><span class="post-toc-number">6.</span> <span class="post-toc-text">ragg2/ragg2·cc</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#rahash2"><span class="post-toc-number">7.</span> <span class="post-toc-text">rahash2</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#radare2"><span class="post-toc-number">8.</span> <span class="post-toc-text">radare2</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#总结"><span class="post-toc-number">9.</span> <span class="post-toc-text">总结</span></a></li></ol>
    </ul>
    




<!-- Layouts -->

    <!-- Post Module -->
    <div class="material-post_container">

        <div class="material-post mdl-grid">
            <div class="mdl-card mdl-shadow--4dp mdl-cell mdl-cell--12-col">

                <!-- Post Header(Thumbnail & Title) -->
                
    <!-- Paradox Post Header -->
    
        
            <!-- Random Thumbnail -->
            <div class="post_thumbnail-random mdl-card__media mdl-color-text--grey-50">
            <script type="text/ls-javascript" id="post-thumbnail-script">
    var randomNum = Math.floor(Math.random() * 19 + 1);

    $('.post_thumbnail-random').attr('data-original', '/img/random/material-' + randomNum + '.png');
    $('.post_thumbnail-random').addClass('lazy');
</script>

        
    
            <p class="article-headline-p">
                一步一步pwn路由器之radare2使用全解
            </p>
        </div>





                
                    <!-- Paradox Post Info -->
                    <div class="mdl-color-text--grey-700 mdl-card__supporting-text meta">

    <!-- Author Avatar -->
    <div id="author-avatar">
        <img src="/img/girl.png" width="44px" height="44px" alt="Author Avatar"/>
    </div>
    <!-- Author Name & Date -->
    <div>
        <strong>hac425</strong>
        <span>10月 31, 2017</span>
    </div>

    <div class="section-spacer"></div>

    <!-- Favorite -->
    <!--
        <button id="article-functions-like-button" class="mdl-button mdl-js-button mdl-js-ripple-effect mdl-button--icon btn-like">
            <i class="material-icons" role="presentation">favorite</i>
            <span class="visuallyhidden">favorites</span>
        </button>
    -->

    <!-- Qrcode -->
    
        <button id="article-functions-qrcode-button" class="mdl-button mdl-js-button mdl-js-ripple-effect mdl-button--icon">
    <i class="material-icons" role="presentation">devices other</i>
    <span class="visuallyhidden">devices other</span>
</button>
<ul class="mdl-menu mdl-menu--bottom-right mdl-js-menu mdl-js-ripple-effect" for="article-functions-qrcode-button">
    <li class="mdl-menu__item">在其它设备中阅读本文章</li>
    
        <img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAPYAAAD2CAAAAADAeSUUAAAC30lEQVR42u3aQXbbMAwEUN//0u0BUjszgNPI1Ncqr0opfi6CBwwff275PLCxsbGxsbGxsbEvyX7Ez9f/9WyFZ+v/Yytf1kneDveMjY2NfTT7mz/9LzedfLg9jtcHOtszNjY29h3YyWeevU1KSH6geakrDhobGxsbe/E77RFs2hJsbGxs7BkpaSqStiRpObCxsbGxN0OlTXgwo15iloaNjY19efZs0P+7P//XfBsbGxv7wuz2ySPbd5W6dz3Y2NjYp7JnA6NZkWsP8fX69WALGxsb+2j2bHAzK3XtqGgTHmBjY2PfgZ0sPdtQO6JKjqMNHrCxsbHvwG7bhn1j0LYQ+U6G+TY2Njb2QexNG5AcRx4D5EUr+SI2Njb22ez8k+22knA3P9xknVW+jY2Njf3h7HyU/66B/qwFyktaMUvDxsbGvgG7LWbtuCdvb1YxMzY2Nvah7Hzcn4e4swPaf6WepWFjY2MfwW4j2Dwk2MQAm7dPDx0bGxv7UHZ+nbFlz0KIWdhQD5WwsbGxj2O3+NmoKN902668eaiEjY2N/VHsfOtt0NseYh4P5yExNjY29h3Ym6uTyeA+eTssSD8xVMLGxsb+QHYyEmrHOpvxU3tlc3X5EhsbG/todluK2mYmb29m7Lfl29jY2NiXZ7cLzYZEm0s/m/KGjY2NfR/2PtZt/yUZ+rfBwDd7xsbGxj6a3bYls2YmP45N2FBcvsTGxsY+jr0vOfsB0/7C0LADw8bGxj6UPUPmo5/ZZaAfL2DY2NjYH8VunxlgEyS05a3Ot7GxsbE/nN0WiVmxyY8pb4TaxgYbGxv7bHZbtJJLPPn6syFR3iZhY2Nj34fdXr7MSfuyNxszYWNjY2MnBSyPZjelsd1PnYpgY2Nj35Kdf3JzfG2jMsy3sbGxsY9g5wOdJJrNQ99ZUWyHWdjY2Nhns2dhbRIVzMLd/BLP8PIlNjY29kHs+zzY2NjY2NjY2NjYl3n+AjF7C22rh92DAAAAAElFTkSuQmCC">
    
</ul>

    

    <!-- Tags (bookmark) -->
    
    <button id="article-functions-viewtags-button" class="mdl-button mdl-js-button mdl-js-ripple-effect mdl-button--icon">
        <i class="material-icons" role="presentation">bookmark</i>
        <span class="visuallyhidden">bookmark</span>
    </button>
    <ul class="mdl-menu mdl-menu--bottom-right mdl-js-menu mdl-js-ripple-effect" for="article-functions-viewtags-button">
        <li class="mdl-menu__item">
        <a class="post_tag-link" href="/tags/radare2/">radare2</a>
    </ul>
    

    <!-- Share -->
    <button id="article-fuctions-share-button" class="mdl-button mdl-js-button mdl-js-ripple-effect mdl-button--icon">
    <i class="material-icons" role="presentation">share</i>
    <span class="visuallyhidden">share</span>
</button>
<ul class="mdl-menu mdl-menu--bottom-right mdl-js-menu mdl-js-ripple-effect" for="article-fuctions-share-button">
    

    
        
            <!-- Busuanzi Views -->
            <a class="post_share-link" href="#">
                <li class="mdl-menu__item">
                    <span id="busuanzi_container_page_pv">
                        <span id="busuanzi_value_page_pv"></span>&nbsp;浏览量
                    </span>
                </li>
            </a>
        
    

    <!-- Share Weibo -->
    
        <a class="post_share-link" href="http://service.weibo.com/share/share.php?appkey=&title=一步一步pwn路由器之radare2使用全解&url=http://blog.hac425.top/2017/10/31/step_by_step_pwn_router_part7.html&pic=http://blog.hac425.top/img/girl.png&searchPic=false&style=simple" target="_blank">
            <li class="mdl-menu__item">
                分享到微博
            </li>
        </a>
    

    <!-- Share Twitter -->
    
        <a class="post_share-link" href="https://twitter.com/intent/tweet?text=一步一步pwn路由器之radare2使用全解&url=http://blog.hac425.top/2017/10/31/step_by_step_pwn_router_part7.html&via=hac425" target="_blank">
            <li class="mdl-menu__item">
                分享到 Twitter
            </li>
        </a>
    

    <!-- Share Facebook -->
    
        <a class="post_share-link" href="https://www.facebook.com/sharer/sharer.php?u=http://blog.hac425.top/2017/10/31/step_by_step_pwn_router_part7.html" target="_blank">
            <li class="mdl-menu__item">
                分享到 Facebook
            </li>
        </a>
    

    <!-- Share Google+ -->
    
        <a class="post_share-link" href="https://plus.google.com/share?url=http://blog.hac425.top/2017/10/31/step_by_step_pwn_router_part7.html" target="_blank">
            <li class="mdl-menu__item">
                分享到 Google+
            </li>
        </a>
    

    <!-- Share LinkedIn -->
    

    <!-- Share QQ -->
    

    <!-- Share Telegram -->
    
</ul>

</div>

                

                <!-- Post Content -->
                <div id="post-content" class="mdl-color-text--grey-700 mdl-card__supporting-text fade out">
    
        <h3 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h3><hr>
<p>本文由 <strong>本人</strong> 首发于 先知安全技术社区：  <a href="https://xianzhi.aliyun.com/forum/user/5274" target="_blank" rel="external">https://xianzhi.aliyun.com/forum/user/5274</a></p>
<hr>
<p><code>radare2</code> 最近越来越流行，已经进入 <code>github</code> 前 25了，看到大佬们纷纷推荐，为了紧跟时代潮流，我也决定探究探究这款 <code>神器</code> 。下面画画重点，以便以后需要用了，可以方便查找。</p>
<h3 id="正文"><a href="#正文" class="headerlink" title="正文"></a>正文</h3><p>首先是安装 <code>radare2</code> ,直接去官方 <code>github</code> 安照指示安装即可。先把源代码下载下来</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">https://github.com/radare/radare2</div></pre></td></tr></table></figure>
<p>然后进入源码目录，执行</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">sys/install.sh</div></pre></td></tr></table></figure>
<p><code>radare2</code> 支持各种各样的平台，文件格式，具体可以看官网描述。它有很多各组件分别进行不同的工作。这些组件是：</p>
<ul>
<li>rax2 ———&gt; 用于数值转换</li>
<li>rasm2  ——-&gt;  反汇编和汇编</li>
<li>rabin2 ——-&gt;  查看文件格式</li>
<li>radiff2 ——&gt;  对文件进行 diff</li>
<li>ragg2/ragg2­cc ——&gt;  用于更方便的生成shellcode</li>
<li>rahash2 ——&gt; 各种密码算法， hash算法</li>
<li>radare2 ——&gt; 整合了上面的工具</li>
</ul>
<h3 id="rax2"><a href="#rax2" class="headerlink" title="rax2"></a>rax2</h3><p>数值转换，程序的 <code>help</code> 菜单很明确了:</p>
<p><img src="http://oy9h5q2k4.bkt.clouddn.com/1509440109544fxedvvf0.png?imageslim" alt="paste image"></p>
<p>比如输入<code>rax2 -s 414141</code> ,会返回 <code>AAAA</code></p>
<h3 id="rabin2"><a href="#rabin2" class="headerlink" title="rabin2"></a>rabin2</h3><p>对各种文件格式进行解析。</p>
<p><code>rabin2 -I hello_pwn</code> 显示文件的信息</p>
<p><img src="http://oy9h5q2k4.bkt.clouddn.com/1509442510111na1s1dfo.png?imageslim" alt="paste image"></p>
<p>使用 <code>-l</code> 显示依赖库。</p>
<p><img src="http://oy9h5q2k4.bkt.clouddn.com/1509442808573t2mk98r0.png?imageslim" alt="paste image"></p>
<p>使用 <code>-zz</code> 显示字符串信息，可以显示 <code>utf-8</code> 等宽字节字符串。</p>
<p><img src="http://oy9h5q2k4.bkt.clouddn.com/1509442931440cmccvl54.png?imageslim" alt="paste image"></p>
<p>可以看到显示了长度，所在位置等信息。</p>
<p>通过使用 <code>-O</code> 选项可以修改一些文件的信息。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line">haclh@ubuntu:~$ rabin2 -O?</div><div class="line">Operation string:</div><div class="line">  Change Entrypoint: e/0x8048000</div><div class="line">  Dump Symbols: d/s/1024</div><div class="line">  Dump Section: d/S/.text</div><div class="line">  Resize Section: r/.data/1024</div><div class="line">  Remove RPATH: R</div><div class="line">  Add Library: a/l/libfoo.dylib</div><div class="line">  Change Permissions: p/.data/rwx</div><div class="line">  Show LDID entitlements: C</div></pre></td></tr></table></figure>
<p>比如修改 <code>section</code> 的属性</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">haclh@ubuntu:~$ rabin2 -S a.out | grep text</div><div class="line">idx=14 vaddr=0x00400430 paddr=0x00000430 sz=386 vsz=386 perm=--rwx name=.text</div><div class="line">haclh@ubuntu:~$ rabin2 -O p/.text/r a.out </div><div class="line">wx 02 @ 0x1d60</div><div class="line">haclh@ubuntu:~$ rabin2 -S a.out | grep text</div><div class="line">idx=14 vaddr=0x00400430 paddr=0x00000430 sz=386 vsz=386 perm=--r-- name=.text</div></pre></td></tr></table></figure>
<h3 id="rasm2"><a href="#rasm2" class="headerlink" title="rasm2"></a>rasm2</h3><p>这个工具用于进行各种平台的汇编和反汇编。该工具的主要选项有。<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">-a 设置汇编和反汇编的架构（比如x86,mips, arm...）</div><div class="line">-L  列举支持的架构。</div><div class="line">-b  设置 位数</div><div class="line">-d，-D  反汇编 提供的 16进制字符串。</div></pre></td></tr></table></figure></p>
<p>使用示例：<br>首先列举支持的架构（使用 <code>head</code> 只列举前面几项）</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line">haclh@ubuntu:~$ rasm2 -L | head</div><div class="line">_dAe  8 16       6502        LGPL3   6502/NES/C64/Tamagotchi/T-1000 CPU</div><div class="line">_dA_  8          8051        PD      8051 Intel CPU</div><div class="line">_dA_  16 32      arc         GPL3    Argonaut RISC Core</div><div class="line">a___  16 32 64   arm.as      LGPL3   as ARM Assembler (use ARM_AS environment)</div><div class="line">adAe  16 32 64   arm         BSD     Capstone ARM disassembler</div><div class="line">_dA_  16 32 64   arm.gnu     GPL3    Acorn RISC Machine CPU</div><div class="line">_d__  16 32      arm.winedbg LGPL2   WineDBG&apos;s ARM disassembler</div><div class="line">adAe  8 16       avr         GPL     AVR Atmel</div><div class="line">adAe  16 32 64   bf          LGPL3   Brainfuck (by pancake, nibble) v4.0.0</div><div class="line">_dA_  16         cr16        LGPL3   cr16 disassembly plugin</div></pre></td></tr></table></figure>
<p>使用 <code>arm</code> 插件，汇编 三条 <code>nop</code> 指令</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">haclh@ubuntu:~$ rasm2 -a arm &quot;nop;nop;nop;&quot;</div><div class="line">0000a0e10000a0e10000a0e1</div></pre></td></tr></table></figure>
<p>然后我们使用 <code>-d</code> 把它反汇编出来</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">haclh@ubuntu:~$ rasm2 -a arm -d 0000a0e10000a0e10000a0e1</div><div class="line">mov r0, r0</div><div class="line">mov r0, r0</div><div class="line">mov r0, r0</div></pre></td></tr></table></figure>
<p>我可以在命令后面加上 <code>-r</code> 打印出在 <code>radare2</code>中实现对应的功能，需要使用的命令( <code>wa</code> 命令的作用是，汇编给出的指令，并把汇编得到的数据写到相应位置，默认是当前位置)。<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">haclh@ubuntu:~$ rasm2 -a arm -d 0000a0e10000a0e10000a0e1 -r</div><div class="line">e asm.arch=arm</div><div class="line">e asm.bits=32</div><div class="line">&quot;wa mov r0, r0;mov r0, r0;mov r0, r0;&quot;</div></pre></td></tr></table></figure></p>
<h3 id="ragg2-ragg2·cc"><a href="#ragg2-ragg2·cc" class="headerlink" title="ragg2/ragg2·cc"></a>ragg2/ragg2·cc</h3><p><code>radare2</code> 自己实现的 c 编译器，可以方便的写<code>shellcode</code> .<br>示例一：</p>
<p>代码如下<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">int main() &#123; write (1,&quot;hi\n&quot;, 3); exit(0); &#125;</div></pre></td></tr></table></figure></p>
<p>使用下面的命令，把它编译成x86 32位代码：</p>
<p><code>ragg2-cc -a x86 -b 32 -d -o test test.c</code></p>
<p><img src="http://oy9h5q2k4.bkt.clouddn.com/1509456151971l3h3i5vj.png?imageslim" alt="paste image"></p>
<p>可以生成正常的 <code>elf</code> 文件用于测试，可以使用 <code>-c</code> 只编译出 <code>shellcode</code> </p>
<p><img src="http://oy9h5q2k4.bkt.clouddn.com/15094562677604lzx38lm.png?imageslim" alt="paste image"><br>生成的 <code>shellcode</code> 存在于 <code>test.c.text</code> 文件里面，下面是用 <code>radare2</code> 反汇编得到的代码，可以看到使用了 系统调用来实现代码的功能。</p>
<p>使用 <code>ragg2-cc</code> 生成的 <code>shellcode</code> 可以使用 <code>ragg2</code>中的 <code>xor</code> 编码器来编码字符，绕过一些字符限制，比如 <code>\x00</code>。<br>首先生成<code>shellcode</code> 的16进制表示。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">ragg2-cc -a x86 -b 32 -d -x test.c</div></pre></td></tr></table></figure>
<p><img src="http://oy9h5q2k4.bkt.clouddn.com/150945684017052tc8caw.png?imageslim" alt="paste image"></p>
<p>然后使用 <code>rasm2</code> 验证下</p>
<p><img src="http://oy9h5q2k4.bkt.clouddn.com/1509456968736cujc5nti.png?imageslim" alt="paste image"><br>代码和上面的是一样的。<br>然后使用 <code>ragg2</code> 使用 <code>xor</code> 编码器编码 <code>shellcode</code></p>
<p><img src="http://oy9h5q2k4.bkt.clouddn.com/1509457754035xiiwmp5s.png?imageslim" alt="paste image"></p>
<p>就是在 <code>shellcode</code> 执行前使用 <code>xor</code> 指令把<code>shellcode</code> 还原。这样就可以消除掉一些坏字符。</p>
<p><code>ragg2</code> 也有自己 编写 <code>shellcode</code> 的语法。下面是一个示例，具体请看官方文档。</p>
<p><img src="http://oy9h5q2k4.bkt.clouddn.com/1509458272098w4gx320m.png?imageslim" alt="paste image"></p>
<p>使用这种方式，我们就能使用最接近 <code>汇编</code> 的类c语言 来编写跨平台 <code>shellcode</code></p>
<h3 id="rahash2"><a href="#rahash2" class="headerlink" title="rahash2"></a>rahash2</h3><p>用于使用加密算法，hash算法等计算值</p>
<p>使用<code>-L</code> 可以列举支持的算法，比如算算 md5<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">haclh@ubuntu:~$ rahash2 -a md5 -s admin</div><div class="line">0x00000000-0x00000004 md5: 21232f297a57a5a743894a0e4a801fc3</div></pre></td></tr></table></figure></p>
<h3 id="radare2"><a href="#radare2" class="headerlink" title="radare2"></a>radare2</h3><p>最常用的工具了。整合了上面所有的工具。直接使用 <code>r2 target_bin</code> 进入程序。使用<code>-d</code> 选项进入调试模式。</p>
<p><img src="http://oy9h5q2k4.bkt.clouddn.com/1509458880413jxib0gco.png?imageslim" alt="paste image"><br><code>radare2</code> 中的命令格式为<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">[.][times][cmd][~grep][@[@iter]addr!size][|&gt;pipe] ;</div></pre></td></tr></table></figure></p>
<p><code>px</code>表示打印16进制数，默认从当前位置开始。参数控制打印的字节数，下面这张图应该就可以大概解释上面的格式了。</p>
<p><img src="http://oy9h5q2k4.bkt.clouddn.com/1509459118495u8fvnh9m.png?imageslim" alt="paste image"></p>
<p><code>@ addr</code> 表示该命令从 <code>addr</code> 开始执行。<code>addr</code> 不一定是 地址也可以是 <code>radare2</code> 中识别的符号，比如 <code>main</code></p>
<p><img src="http://oy9h5q2k4.bkt.clouddn.com/150945933341282rex3iw.png?imageslim" alt="paste image"><br>还有一个重要的东西要记得，在命令的后面加个 <code>?</code> ，就可以查看帮助。直接输入<code>?</code> 可以查看所有的命令。</p>
<p><img src="http://oy9h5q2k4.bkt.clouddn.com/1509459469161neog4ssx.png?imageslim" alt="paste image"></p>
<p>下面按照我们在 <code>ida</code> 中使用的功能，来介绍 <code>radare2</code><br>首先在 用 <code>ida</code> 分析程序时，在 <code>ida</code> 加载程序后默认会对程序进行分析。<code>radare2</code> 相应的功能是以 <code>a</code> 开头的。</p>
<p><img src="http://oy9h5q2k4.bkt.clouddn.com/1509459639393vrpsfsr3.png?imageslim" alt="paste image"><br>注释很简明了。我们使用 <code>aaa</code> 就可以进行完整分析了。<br><img src="http://oy9h5q2k4.bkt.clouddn.com/1509459732526wt8fv8vk.png?imageslim" alt="paste image"></p>
<p>分析前 <code>radare2</code> 识别不了函数，分析后就可以正常打印函数代码了（<code>pdf</code> 打印函数代码）</p>
<p><img src="http://oy9h5q2k4.bkt.clouddn.com/1509459800808z40o2w75.png?imageslim" alt="paste image"></p>
<p>有时候我们不需要分析整个 二进制文件，或者有个函数  <code>radare2</code>没有识别出来我们可以 <code>af</code> 来分析该函数。</p>
<p><img src="http://oy9h5q2k4.bkt.clouddn.com/1509460038689y3ejljvr.png?imageslim" alt="paste image"></p>
<p>我们可以使用  <code>s</code> 跳转到想要跳转的位置。<br>跳转到 <code>main</code> 函数，并 定义该函数，然后打印函数代码</p>
<p><img src="http://oy9h5q2k4.bkt.clouddn.com/15094601604612rtzywu2.png?imageslim" alt="paste image"></p>
<p><code>pd</code>  类命令用于打印汇编信息。</p>
<p><img src="http://oy9h5q2k4.bkt.clouddn.com/1509460248195wabrhoh5.png?imageslim" alt="paste image"></p>
<p>具体看帮助。<br>使用 <code>VV</code> 进入 图形化模式（需要是函数范围内）。</p>
<p><img src="http://oy9h5q2k4.bkt.clouddn.com/15094603917512ee12s3o.png?imageslim" alt="paste image"><br>在图形化模式下，输入 <code>?</code> 可以查看图形化模式的帮助。</p>
<p><img src="http://oy9h5q2k4.bkt.clouddn.com/1509460451292vd4u4cma.png?imageslim" alt="paste image"></p>
<p>使用 <code>hjkl</code> 来移动图形</p>
<p><img src="http://oy9h5q2k4.bkt.clouddn.com/1509460648267s237v95k.png?imageslim" alt="paste image"></p>
<p>使用 <code>p/P</code>  切换图形模式</p>
<p><img src="http://oy9h5q2k4.bkt.clouddn.com/1509460704922bax3wo07.png?imageslim" alt="paste image"></p>
<p>在图形模式下使用 <code>:</code> 可以输入<code>radare2</code> 命令</p>
<p><img src="http://oy9h5q2k4.bkt.clouddn.com/1509461026761tbpeekgu.png?imageslim" alt="paste image"></p>
<p>输入 <code>!</code> ， 在调试的时候应该很有用</p>
<p><img src="http://oy9h5q2k4.bkt.clouddn.com/1509461098057g2hz9wjr.png?imageslim" alt="paste image"></p>
<p>使用 空格 ，切换图形模式和文本模式</p>
<p><img src="http://oy9h5q2k4.bkt.clouddn.com/1509460817550ho8w5er5.png?imageslim" alt="paste image"></p>
<p>在文本模式模式下也可以使用 <code>p</code> 来切换视图。</p>
<p><img src="http://oy9h5q2k4.bkt.clouddn.com/1509460884141o5b4k28f.png?imageslim" alt="paste image"><br>剩下的看帮助。</p>
<p>下面介绍如何使用 <code>radare2</code> patch程序。首先需要在打开文件时使用 <code>r2 -w</code> 来以可写模式打开文件，这样 <code>pathch</code> 才能应用到文件 ( 或者在 <code>radare2</code> 下使用 <code>e io.cache=true</code>, 来允许进行 <code>patch</code>, 不过这样的话文件的修改不会影响原文件 )</p>
<p><code>w</code> 系列命令用于修改文件。</p>
<p>使用 <code>wa</code> 可以使用 汇编指令进行 <code>patch</code><br><img src="http://oy9h5q2k4.bkt.clouddn.com/1509461504180vks7xzbj.png?imageslim" alt="paste image"></p>
<p>使用 <code>&quot;wa nop;nop;nop;nop;&quot;</code> 可以同时写入多条指令。<br><code>双引号不能省</code></p>
<p><img src="http://oy9h5q2k4.bkt.clouddn.com/1509461564911w4lzfklw.png?imageslim" alt="paste image"><br>或者可以使用 <code>wx</code> 写入 16进制数据<br><img src="http://oy9h5q2k4.bkt.clouddn.com/1509461691131dl2qawda.png?imageslim" alt="paste image"><br>其他的请看 <code>w?</code> ，查看帮助。</p>
<p>还可以 <code>可视化汇编/patch</code> 程序</p>
<p>输入 <code>Vp</code> ，然后输入 <code>A</code>, 就可以了。</p>
<p><img src="http://oy9h5q2k4.bkt.clouddn.com/1509461967246b3yfuntc.png?imageslim" alt="paste image"></p>
<p>使用 <code>/</code> 系列命令可以搜索字符串， rop gadgets等</p>
<p><img src="http://oy9h5q2k4.bkt.clouddn.com/15094620829681a9ko1pz.png?imageslim" alt="paste image"></p>
<p>查询字符串交叉引用可以依次使用下列方法。</p>
<p><img src="http://oy9h5q2k4.bkt.clouddn.com/1509462186812m98x995a.png?imageslim" alt="paste image"></p>
<p><code>ax?</code> 系列命令用于管理交叉引用。 <code>/r</code> 可以搜索交叉引用,  <code>aae</code>  是使用<code>radare2</code>中的模拟执行功能，动态的检测交叉引用。</p>
<p><strong>下面画重点</strong></p>
<p><code>radare2</code>中其实也是有 <code>反编译功能</code>, 使用 <code>pdc</code>  就可以查看伪代码，虽然和 <code>ida</code> 的还有很大的差距，但是在一些  <code>ida</code>  不支持 <code>f5</code> 的情况下这个功能还是不错的，可以用来看程序的大概逻辑。</p>
<p><img src="http://oy9h5q2k4.bkt.clouddn.com/1509462614283a92qwc4d.png?imageslim" alt="paste image"></p>
<p>在图形化模式下，按下 <code>$</code> 看看，有惊喜。<br><img src="http://oy9h5q2k4.bkt.clouddn.com/1509462803351x6n0h9gz.png?imageslim" alt="paste image"><br>帮我们解析汇编指令，用 c 代码的格式来显示。妈妈再也不用担心我不会汇编了。</p>
<p><code>radare2</code>和  <code>ida</code> 相比还有一个最大的优势，那就是它自带模拟执行功能。它使用了一种 <code>esil</code> 语言，来定义程序的行为，并且可以根据这个来模拟执行程序代码。 </p>
<p><code>ESIL</code> 的具体语法可以去看官方文档。下面列举两个示例：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">mov ecx, ebx -&gt; ebx,ecx,=</div><div class="line">add ebx, edi -&gt;edi,ebx,+=,$o,of,=,$s,sf,=,$z,zf,=,$c31,cf,=,$p,</div></pre></td></tr></table></figure>
<p>可以使用 <code>e asm.esil = true</code>显示 <code>esil</code> 代码</p>
<p><img src="http://oy9h5q2k4.bkt.clouddn.com/1509464681373qlis3k0v.png?imageslim" alt="paste image"><br>和 <code>ESIL</code>相关的命令是 </p>
<p><code>ae?</code>这一类指令。这个我也不熟悉，大概的用法是，使用 <code>ae?</code>这一类指令设置好 指令执行虚拟机的状态，然后设置好模拟执行的终止状态，在停止时，做一些操作，主要用于解密字符串，脱壳等等。</p>
<p>具体事例可以看：</p>
<p><a href="https://blog.xpnsec.com/radare2-using-emulation-to-unpack-metasploit-encoders/" target="_blank" rel="external">https://blog.xpnsec.com/radare2-using-emulation-to-unpack-metasploit-encoders/</a></p>
<p>此外 <code>radare2</code>还支持各种语言对他进行调用， 以及拥有大量的插件。</p>
<h3 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h3><p> <code>radare2</code>还是很强大的，特别是全平台反编译，全平台模拟执行，各种文件的patch, 修改。感觉在 ida 没法 <code>f5</code>的平台上首选 <code>radare2</code></p>
<p> 参考：</p>
<p> <a href="http://radare.org/r/talks.html" target="_blank" rel="external">http://radare.org/r/talks.html</a></p>
<p> <a href="https://github.com/radare/radare2book" target="_blank" rel="external">https://github.com/radare/radare2book</a></p>
<p> <a href="https://codeload.github.com/radareorg/r2con/" target="_blank" rel="external">https://codeload.github.com/radareorg/r2con/</a></p>

        
                <blockquote style="margin: 2em 0 0;padding: 0.5em 1em;border-left: 3px solid #F44336;background-color: #F5F5F5;list-style: none;">
                    <p><strong>
                         
                            <a>本站文章均原创， 转载注明来源</a>
                        </strong>
                        <br>
                        <strong>本文链接：</strong><a href="http://blog.hac425.top/2017/10/31/step_by_step_pwn_router_part7.html">http://blog.hac425.top/2017/10/31/step_by_step_pwn_router_part7.html</a>
                    </p>
                </blockquote>
        
    

    
</div>


                

                <!-- Post Comments -->
                
                    
    <!-- 使用 来必力 -->
<div id="livere-comment">
    <!-- 来必力City版安装代码 -->
<div id="lv-container" data-id="city" data-uid="MTAyMC8zMTQ2OC84MDMy">
<script type="text/javascript">
   (function(d, s) {
       var j, e = d.getElementsByTagName(s)[0];

       if (typeof LivereTower === 'function') { return; }

       j = d.createElement(s);
       j.src = 'https://cdn-city.livere.com/js/embed.dist.js';
       j.async = true;

       e.parentNode.insertBefore(j, e);
   })(document, 'script');
</script>
<noscript>为正常使用来必力评论功能请激活JavaScript</noscript>
</div>
<!-- City版安装代码已完成 -->
</div>
<style>
    #livere-comment{
        background-color: #eee;
        padding: 2pc;
    }
</style>

                
            </div>

            <!-- Post Prev & Next Nav -->
            <nav class="material-nav mdl-color-text--grey-50 mdl-cell mdl-cell--12-col">
    <!-- Prev Nav -->
    
        <a href="/2017/11/01/step_by_step_pwn_router_part8.html" id="post_nav-newer" class="prev-content">
            <button class="mdl-button mdl-js-button mdl-js-ripple-effect mdl-button--icon mdl-color--white mdl-color-text--grey-900" role="presentation">
                <i class="material-icons">arrow_back</i>
            </button>
            &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
            新篇
        </a>
    

    <!-- Section Spacer -->
    <div class="section-spacer"></div>

    <!-- Next Nav -->
    
        <a href="/2017/10/29/step_by_step_pwn_router_part5.html" id="post_nav-older" class="next-content">
            旧篇
            &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
            <button class="mdl-button mdl-js-button mdl-js-ripple-effect mdl-button--icon mdl-color--white mdl-color-text--grey-900" role="presentation">
                <i class="material-icons">arrow_forward</i>
            </button>
        </a>
    
</nav>

        </div>
    </div>



                    
                        <!-- Overlay For Active Sidebar -->
<div class="sidebar-overlay"></div>

<!-- Material sidebar -->
<aside id="sidebar" class="sidebar sidebar-colored sidebar-fixed-left" role="navigation">
    <div id="sidebar-main">
        <!-- Sidebar Header -->
        <div class="sidebar-header header-cover" style="background-image: url(/img/sidebar_header.png);">
    <!-- Top bar -->
    <div class="top-bar"></div>

    <!-- Sidebar toggle button -->
    <button type="button" class="sidebar-toggle mdl-button mdl-js-button mdl-js-ripple-effect mdl-button--icon" style="display: initial;" data-upgraded=",MaterialButton,MaterialRipple">
        <i class="material-icons">clear_all</i>
        <span class="mdl-button__ripple-container">
            <span class="mdl-ripple">
            </span>
        </span>
    </button>

    <!-- Sidebar Avatar -->
    <div class="sidebar-image">
        <img src="/img/girl.png" alt="hac425's avatar">
    </div>

    <!-- Sidebar Email -->
    <a data-toggle="dropdown" class="sidebar-brand" href="#settings-dropdown">
        hac425xxx@gmail.com
        <b class="caret"></b>
    </a>
</div>


        <!-- Sidebar Navigation  -->
        <ul class="nav sidebar-nav">
    <!-- User dropdown  -->
    <li class="dropdown">
        <ul id="settings-dropdown" class="dropdown-menu">
            
                <li>
                    <a href="#" target="_blank" title="Email Me">
                        
                            <i class="material-icons sidebar-material-icons sidebar-indent-left1pc-element">email</i>
                        
                        Email Me
                    </a>
                </li>
            
        </ul>
    </li>

    <!-- Homepage -->
    
        <li id="sidebar-first-li">
            <a href="/">
                
                    <i class="material-icons sidebar-material-icons">home</i>
                
                主页
            </a>
        </li>
        
    

    <!-- Archives  -->
    
        <li class="dropdown">
            <a href="#" class="ripple-effect dropdown-toggle" data-toggle="dropdown">
                
                    <i class="material-icons sidebar-material-icons">inbox</i>
                
                    归档
                <b class="caret"></b>
            </a>
            <ul class="dropdown-menu">
            <li>
                <a class="sidebar_archives-link" href="/archives/2018/05/">五月 2018<span class="sidebar_archives-count">7</span></a></li><li><a class="sidebar_archives-link" href="/archives/2018/04/">四月 2018<span class="sidebar_archives-count">5</span></a></li><li><a class="sidebar_archives-link" href="/archives/2018/03/">三月 2018<span class="sidebar_archives-count">14</span></a></li><li><a class="sidebar_archives-link" href="/archives/2018/02/">二月 2018<span class="sidebar_archives-count">1</span></a></li><li><a class="sidebar_archives-link" href="/archives/2018/01/">一月 2018<span class="sidebar_archives-count">8</span></a></li><li><a class="sidebar_archives-link" href="/archives/2017/12/">十二月 2017<span class="sidebar_archives-count">13</span></a></li><li><a class="sidebar_archives-link" href="/archives/2017/11/">十一月 2017<span class="sidebar_archives-count">8</span></a></li><li><a class="sidebar_archives-link" href="/archives/2017/10/">十月 2017<span class="sidebar_archives-count">11</span></a></li><li><a class="sidebar_archives-link" href="/archives/2017/08/">八月 2017<span class="sidebar_archives-count">1</span></a>
            </ul>
        </li>
        
    

    <!-- Categories  -->
    
        <li class="dropdown">
            <a href="#" class="ripple-effect dropdown-toggle" data-toggle="dropdown">
                
                    <i class="material-icons sidebar-material-icons">chrome_reader_mode</i>
                
                分类
                <b class="caret"></b>
            </a>
            <ul class="dropdown-menu">
                <li>
                <a class="sidebar_archives-link" href="/categories/Vulnerability-analysis/">Vulnerability analysis<span class="sidebar_archives-count">1</span></a></li><li><a class="sidebar_archives-link" href="/categories/chrome/">chrome<span class="sidebar_archives-count">1</span></a></li><li><a class="sidebar_archives-link" href="/categories/ctf/">ctf<span class="sidebar_archives-count">20</span></a></li><li><a class="sidebar_archives-link" href="/categories/embedded-development/">embedded_development<span class="sidebar_archives-count">1</span></a></li><li><a class="sidebar_archives-link" href="/categories/java应用破解思路/">java应用破解思路<span class="sidebar_archives-count">1</span></a></li><li><a class="sidebar_archives-link" href="/categories/jeb破解/">jeb破解<span class="sidebar_archives-count">2</span></a></li><li><a class="sidebar_archives-link" href="/categories/kernel/">kernel<span class="sidebar_archives-count">1</span></a></li><li><a class="sidebar_archives-link" href="/categories/pwn-router-os/">pwn_router_os<span class="sidebar_archives-count">3</span></a></li><li><a class="sidebar_archives-link" href="/categories/reverse/">reverse<span class="sidebar_archives-count">1</span></a></li><li><a class="sidebar_archives-link" href="/categories/vulnerability-report/">vulnerability_report<span class="sidebar_archives-count">2</span></a></li><li><a class="sidebar_archives-link" href="/categories/代码审计/">代码审计<span class="sidebar_archives-count">4</span></a></li><li><a class="sidebar_archives-link" href="/categories/安卓安全/">安卓安全<span class="sidebar_archives-count">6</span></a></li><li><a class="sidebar_archives-link" href="/categories/文件patch/">文件patch<span class="sidebar_archives-count">1</span></a></li><li><a class="sidebar_archives-link" href="/categories/渗透测试/">渗透测试<span class="sidebar_archives-count">11</span></a></li><li><a class="sidebar_archives-link" href="/categories/破解/">破解<span class="sidebar_archives-count">1</span></a></li><li><a class="sidebar_archives-link" href="/categories/路由器安全/">路由器安全<span class="sidebar_archives-count">11</span></a>
            </ul>
        </li>
        
            <li class="divider"></li>
        
    

    <!-- Pages  -->
    
        <li>
            <a href="/about" title="关于我">
                
                    <i class="material-icons sidebar-material-icons">person</i>
                
                关于我
            </a>
        </li>
        
    
        <li>
            <a href="/timeline" title="时间轴">
                
                    <i class="material-icons sidebar-material-icons">timeline</i>
                
                时间轴
            </a>
        </li>
        
    
        <li>
            <a href="/links" title="友情链接">
                
                    <i class="material-icons sidebar-material-icons">people</i>
                
                友情链接
            </a>
        </li>
        
    
        <li>
            <a href="/tags" title="标签云">
                
                    <i class="material-icons sidebar-material-icons">invert_colors</i>
                
                标签云
            </a>
        </li>
        
    

    <!-- Article Number  -->
    
        <li>
            <a href="/archives">
                文章总数
                <span class="sidebar-badge">68</span>
            </a>
        </li>
        
    
</ul>


        <!-- Sidebar Footer -->
        <!--
I'm glad you use this theme, the development is no so easy, I hope you can keep the copyright, I will thank you so much.
If you still want to delete the copyrights, could you still retain the first one? Which namely "Theme Material"
It will not impact the appearance and can give developers a lot of support :)

很高兴您使用并喜欢该主题，开发不易 十分谢谢与希望您可以保留一下版权声明。
如果您仍然想删除的话 能否只保留第一项呢？即 "Theme Material"
它不会影响美观并可以给开发者很大的支持和动力。 :)
-->

<!-- Sidebar Divider -->


<!-- Theme Material -->


<!-- Help & Support -->
<!--

-->

<!-- Feedback -->
<!--

-->

<!-- About Theme -->
<!--

-->

    </div>

    <!-- Sidebar Image -->
    

</aside>

                    

                    
                        <!-- Footer Top Button -->
                        <div id="back-to-top" class="toTop-wrap">
    <a href="#top" class="toTop">
        <i class="material-icons footer_top-i">expand_less</i>
    </a>
</div>

                    

                    <script>
(function(){
    var bp = document.createElement('script');
    var curProtocol = window.location.protocol.split(':')[0];
    if (curProtocol === 'https') {
        bp.src = 'https://zz.bdstatic.com/linksubmit/push.js';
    }
    else {
        bp.src = 'http://push.zhanzhang.baidu.com/push.js';
    }
    var s = document.getElementsByTagName("script")[0];
    s.parentNode.insertBefore(bp, s);
})();
</script>

<!--Footer-->
<footer class="mdl-mini-footer" id="bottom">
    
        <!-- Paradox Footer Left Section -->
        <div class="mdl-mini-footer--left-section sns-list">
    <!-- Twitter -->
    
        <a href="https://twitter.com/hac425" target="_blank">
            <button class="mdl-mini-footer--social-btn social-btn footer-sns-twitter">
                <span class="visuallyhidden">Twitter</span>
            </button><!--
     --></a>
    

    <!-- Facebook -->
    

    <!-- Google + -->
    

    <!-- Weibo -->
    
        <a href="http://weibo.com/u/5691483590" target="_blank">
            <button class="mdl-mini-footer--social-btn social-btn footer-sns-weibo">
                <span class="visuallyhidden">Weibo</span>
            </button><!--
     --></a>
    

    <!-- Instagram -->
    

    <!-- Tumblr -->
    

    <!-- Github -->
    
        <a href="https://gitee.com/hac425/" target="_blank">
            <button class="mdl-mini-footer--social-btn social-btn footer-sns-github">
                <span class="visuallyhidden">Github</span>
            </button><!--
     --></a>
    

    <!-- LinkedIn -->
    

    <!-- Zhihu -->
    

    <!-- Bilibili -->
    

    <!-- Telegram -->
    
    
    <!-- V2EX -->
    
</div>


        <!--Copyright-->
        <div id="copyright">
            Copyright&nbsp;©<script type="text/javascript">var fd = new Date();document.write("&nbsp;" + fd.getFullYear() + "&nbsp;");</script>穷则变，变则通，通则久
            
        </div>

        <!-- Paradox Footer Right Section -->

    
</footer>


                    <!-- Import JS File -->

    <script>lsloader.load("lazyload_js","/js/lazyload.min.js?wgjW/HuQG9JDgvPDPoRAng==", true)</script>



    <script>lsloader.load("js_js","/js/js.min.js?V/53wGualMuiPM3xoetD5Q==", true)</script>



    <script>lsloader.load("np_js","/js/nprogress.js?pl3Qhb9lvqR1FlyLUna1Yw==", true)</script>


<script type="text/ls-javascript" id="NProgress-script">
    NProgress.configure({
        showSpinner: true
    });
    NProgress.start();
    $('#nprogress .bar').css({
        'background': '#29d'
    });
    $('#nprogress .peg').css({
        'box-shadow': '0 0 10px #29d, 0 0 15px #29d'
    });
    $('#nprogress .spinner-icon').css({
        'border-top-color': '#29d',
        'border-left-color': '#29d'
    });
    setTimeout(function() {
        NProgress.done();
        $('.fade').removeClass('out');
    }, 800);
</script>







    <!-- Busuanzi -->
    <script src="https://dn-lbstatics.qbox.me/busuanzi/2.3/busuanzi.pure.mini.js"></script>



   





<!-- UC Browser Compatible -->
<script>
	var agent = navigator.userAgent.toLowerCase();
	if(agent.indexOf('ucbrowser')>0) {
		document.write('<link rel="stylesheet" href="/css/uc.css">');
	   alert('由于 UC 浏览器使用极旧的内核，而本网站使用了一些新的特性。\n为了您能更好的浏览，推荐使用 Chrome 或 Firefox 浏览器。');
	}
</script>

<!-- Import prettify js  -->


    
        <script>lsloader.load("hanabi","/js/hanabi-browser-bundle.js?5+2z7ZZmFuZK5IcimlZbxw==", true)</script>
    


<!-- Window Load -->
<!-- add class for prettify -->
<script type="text/ls-javascript" id="window-load">
    $(window).on('load', function() {
        // Post_Toc parent position fixed
        $('.post-toc-wrap').parent('.mdl-menu__container').css('position', 'fixed');
    });

    
    
        
        
        HanabiBrowser.start('pre code',true);
    
</script>

<!-- MathJax Load-->


<!-- Bing Background -->


<script type="text/ls-javascript" id="lazy-load">
    // Offer LazyLoad
    queue.offer(function(){
        $('.lazy').lazyload({
            effect : 'show'
        });
    });

    // Start Queue
    $(document).ready(function(){
        setInterval(function(){
            queue.execNext();
        },200);
    });
</script>

<!-- Custom Footer -->



<script>
    (function(){
        var scriptList = document.querySelectorAll('script[type="text/ls-javascript"]')

        for (var i = 0; i < scriptList.length; ++i) {
            var item = scriptList[i];
            lsloader.runInlineScript(item.id,item.id);
        }
    })()
console.log('\n %c © Material Theme | Version: 1.5.0 | https://github.com/viosey/hexo-theme-material %c \n', 'color:#455a64;background:#e0e0e0;padding:5px 0;border-top-left-radius:5px;border-bottom-left-radius:5px;', 'color:#455a64;background:#e0e0e0;padding:5px 0;border-top-right-radius:5px;border-bottom-right-radius:5px;');
</script>

                </main>
            </div>
        </body>
    
</html>
